# Ubuntu Server + Nginx構築練習まとめ

---

## ✅ ゴール
- 仮想環境（VirtualBox）にUbuntu Server 22.04.5 LTSをインストール
- Nginxサーバーを構築し、ブラウザからアクセス確認
- 自作HTMLページを公開
- 仮想マシンを安全にシャットダウン

---

## ✅ 実施した手順

### 1. VirtualBox仮想マシン作成
- メモリ：2048MB
- 仮想ディスク：20GB（SATA接続）
- ISOファイル：ubuntu-22.04.5-live-server-amd64.iso
- NAT接続＋ポートフォワーディング設定（ホスト8080→ゲスト80）

### 2. Ubuntu Serverインストール
- English選択
- キーボード：English(US)
- ネットワーク：自動取得（DHCP）
- ディスク設定：自動（Use an entire disk）
- OpenSSH server導入
- Snapアプリ選択なし（スキップ）

### 3. Nginxインストール
```bash
sudo apt update
sudo apt install nginx
```

### 4. Nginx動作確認
- 仮想マシン内でNginx起動確認
```bash
systemctl status nginx
```
- ブラウザでアクセス
```
http://localhost:8080
```
- 「Welcome to nginx!」表示確認

### 5. オリジナルページ作成
- `/var/www/html/`ディレクトリに移動
```bash
cd /var/www/html
```
- 新しい `index.html` 作成
```bash
sudo nano index.html
```
- HTML内容（例）
```html
<!DOCTYPE html>
<html>
<head>
    <title>My First Server</title>
</head>
<body>
    <h1>Hello World from My Ubuntu Server!</h1>
</body>
</html>
```
- ブラウザリロードでオリジナルページ表示確認！

### 6. 仮想マシンのシャットダウン
```bash
sudo shutdown now
```
または
```bash
sudo poweroff
```

---

## ✅ 理解ポイントまとめ

| 項目 | 理解したこと |
|:--|:--|
| localhostとは？ | 自分のPC自身へのアクセスを指す特別な名前 |
| ポートフォワーディングとは？ | ホストPCから仮想マシンへの通信中継設定 |
| Guest Additionsとは？ | コピペや画面サイズ調整などを可能にする仮想化ドライバ |
| 実務でHTMLを作る場所は？ | サーバー上ではなく、ローカルエディタ（VS Codeなど） |
| デプロイとは？ | 作ったコードを実際のサーバーに反映すること |

---
---

## 🤔 Nginxと実務スキルの整理メモ（考察＋QA）

---

### ✅ Nginxの用途は？

Nginxは「Webサイトを公開するための軽量・高速なサーバー」で、以下の用途に使える：

- HTMLなどの**静的ファイルの配信**
- APIやバックエンドに処理を**中継（リバースプロキシ）**
- 複数のバックエンドへリクエストを振り分ける**ロードバランサー**
- HTTPS（SSL/TLS）化による**通信の暗号化とセキュリティ対応**

---

### 🤔 APIユーザーって「人」じゃないの？

> 「ユーザー」って言葉の印象から、人間を想像したが実際は？

✅ **APIユーザー = APIを利用するすべての存在（人間に限らない）**

| タイプ | 具体例 |
|:--|:--|
| 人間 | ブラウザから商品購入、チャット投稿など |
| プログラム | スマホアプリ、JavaScript、他のサーバー |

📌 APIユーザーは「人 or アプリ or スクリプト」。**APIにリクエストを送るもの全部**を指す！

---

### 🤔 ドメインは「住所」って例えで合ってる？

✅ その通り！

- `example.com` ＝ 人間が覚えやすい名前（住所）
- 実際にはDNSが `192.0.2.1` のようなIPアドレスに変換してくれる

---

### 🤔 `/var/www/html/` にあるファイルがサイトの正体？

✅ その通り！

- Nginxは `/etc/nginx/sites-available/default` でルート（root）を設定
- そこに指定された `/var/www/html` にある `index.html` などを返す

📌 **複数のサイトを運用したいときは、PATHを `/var/www/〇〇` ごとに切り分けて、ドメインごとに振り分ける。**

---

### 🤔 複数サイト運用って「負荷分散」してる？

❌ それは少し違う！

- **複数サイト運用**（バーチャルホスト）  
  → 「1台のNginxで複数のWebサイトを運用する」こと

- **負荷分散**（ロードバランシング）  
  → 「リクエストを複数のアプリやサーバーに割り振る」こと

---

### ✅ ロードバランサーとは？

> リクエストが多いとき、どこに振るか決める仕組み

Nginxは以下のような構成でロードバランサーになる：

```
Nginx（ロードバランサー）
 ├─ Appサーバー①
 ├─ Appサーバー②
 └─ Appサーバー③
```

- 実際のサーバー（物理・仮想）を取り仕切る
- 1台のPCに複数VMでも使える
- PATHごとの分岐でも振り分け可能（例：`/api`, `/static`）

---

### 🤔 HTTPS化は「アプリを入れるだけ」じゃない？

✅ Yes, but...実務はそこからが本番！

| 内容 | 説明 |
|:--|:--|
| 証明書の取得 | Let's Encryptなどで取得（Certbot） |
| 自動更新 | cronで定期実行 or systemd.timer |
| 即時反映 | reloadで反映（再起動不要が理想） |
| セキュリティ対策 | ポート設定、認証、BAN（fail2banなど） |

---

### 🤔 VirtualBoxの共有フォルダはなぜ実務で不要？

✅ ローカル内の便利機能だから！

| 理由 | 内容 |
|:--|:--|
| 範囲が限定的 | あくまで1台のPCの中だけの共有 |
| 実務では使わない | GitHub + CI/CD + SSH or rsync などで運用 |
| 学習用には便利 | 最初のコピーやテストには使えるが、本番では役不足 |

---

### ✅ 今後の実践ステップ方針（確認済）

| ステップ | 内容 |
|:--|:--|
| ① Nginx設定ファイルの編集 | `/etc/nginx/sites-available/default` をいじって、何ができるか把握する |
| ② 自動化・ログ収集・運用基盤づくり | 再起動不要な反映、ログローテート、自動更新の準備 |
| ③＋⑤ 複数サイト構成 × 開発環境連動 | 複数ドメイン運用＋ローカルHTMLからのデプロイ練習 |
| ④ 最後にSSL導入（Let's Encrypt） | HTTPS対応とセキュリティ強化を実施して完成へ |

---